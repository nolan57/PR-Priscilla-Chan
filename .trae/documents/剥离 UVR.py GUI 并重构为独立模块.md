# 剥离 UVR.py GUI 并重构为独立模块

## 1. 分析现状

UVR.py 是一个集成了 GUI 和核心功能的大型文件，主要包含：
- **GUI 部分**：基于 Tkinter 的界面实现
- **核心功能**：音频分离、模型管理、文件处理等
- **工具类**：ModelData、Ensembler 等

## 2. 剥离方案

### 2.1 模块划分

| 模块名称 | 功能描述 | 文件路径 |
|---------|---------|----------|
| `core/models.py` | 模型管理（ModelData 类） | 从 UVR.py 提取 |
| `core/separators.py` | 音频分离引擎 | 从 UVR.py 提取 |
| `core/ensemble.py` | 模型集成功能 | 从 UVR.py 提取 |
| `core/utils.py` | 工具函数 | 从 UVR.py 提取 |
| `core/config.py` | 配置管理 | 新创建 |
| `cli.py` | 命令行接口 | 新创建 |
| `main.py` | 主入口 | 新创建 |

### 2.2 实现步骤

1. **提取核心类和函数**
   - 从 UVR.py 中提取 ModelData、Ensembler 等核心类
   - 提取音频分离相关函数
   - 提取工具函数

2. **创建配置管理模块**
   - 实现配置文件加载和保存
   - 提供默认配置

3. **实现命令行接口**
   - 支持命令行参数解析
   - 实现与原 GUI 相同的功能

4. **重构依赖关系**
   - 移除所有 Tkinter 依赖
   - 重构配置获取方式
   - 重构日志和错误处理

5. **测试验证**
   - 验证核心功能正常工作
   - 测试命令行接口
   - 确保与原功能兼容

## 3. 核心功能保留

- ✅ 所有模型架构支持（VR、MDX-Net、Demucs）
- ✅ 模型集成功能
- ✅ 音频处理工具
- ✅ 配置管理
- ✅ 批量处理
- ✅ GPU 加速支持

## 4. 预期结果

- 完全移除 GUI 依赖
- 保留所有核心功能
- 提供命令行接口
- 模块化设计，便于维护和扩展
- 与原功能完全兼容

## 5. 技术要点

- **依赖管理**：确保所有必要的库都被正确引用
- **配置处理**：实现灵活的配置管理
- **错误处理**：提供清晰的错误信息
- **日志记录**：保留原有的日志功能
- **性能优化**：保持原有的性能特性